# 服务与部署指南

## 业务概览
本服务定位为“内容自动化工厂”的后端基座，核心流程是：
1. 从外部热点数据源拉取话题（如微博热榜）。
2. 使用大模型生成文章解读稿（Markdown）。
3. 将文章进一步生成视频脚本（JSON）。
4. 将内容落盘，按日期归档，便于后续打包发布。

## 模块与职责
- `caas-integration`：外部数据源接入，例如 `WeiboHotSource`。
- `caas-llm`：与大模型解耦的抽象层与处理器（Prompt 构建与解析）。
- `caas-domain`：业务领域模型（热点、文章、脚本等）。
- `caas-pipeline`：流水线 SPI 与引擎实现。
- `caas-storage`：结果输出与归档（文件系统落地）。
- `caas-app`：应用入口与示例运行。

## 运行与部署

### 本地运行（最小示例）
执行示例会在本地生成 Markdown 与视频脚本 JSON 文件：
```bash
mvn -pl caas-app -am exec:java -Dexec.mainClass=com.caas.app.PipelineExampleRunner
```
生成目录：`output/yyyy-MM-dd/`。

### 服务化部署建议
- **JDK**：Java 21。
- **构建**：`mvn clean package` 或 `mvn clean install`。
- **启动**：建议将 `caas-app` 作为可执行模块进行打包与运行。
- **配置**：目前仅提供示例配置文件 `caas-app/src/main/resources/application.yml`，生产环境需要补充真实的 LLM 与数据源配置。

## 配置说明
目前的配置以占位为主，建议在生产环境通过环境变量或配置中心注入：
- `SERVER_PORT`
- `CAAS_LLM_PROVIDER`
- `CAAS_LLM_API_KEY`
- `CAAS_STORAGE_URL`
- `CAAS_STORAGE_USERNAME`
- `CAAS_STORAGE_PASSWORD`

## 输出与归档
`FileSystemOutput` 的输出规则：
- 按日期创建目录（`yyyy-MM-dd`）。
- 每篇内容输出：
  - `*.md`（文章 Markdown）
  - `*.video.json`（视频脚本 JSON）
- 文件名稳定、可读，适合后续直接打包为 zip 归档。

## 常见扩展点
- 接入更多热点源（新增 `Source<HotTopic>` 实现）。
- 新增内容处理链路（继承 `LlmProcessor` 实现新的 Processor）。
- 输出到对象存储或数据库（新增 `Output` 实现）。
